Itrmax2_catalyst = ceil( Itrmax2 ^ 2 / ritr_Catalyst );
Itrmax2_cs = ceil(Itrmax ^2 / ritr_Catalyst_Screening);
Itrmax2_svrg = ceil( Itrmax2 * 3 / 4 );
Itrmax2_ss = ceil(Itrmax2 * 3 / 4 );
% semilogy(1:100:Itrmax1,err_SASC_hist(1:100:Itrmax1),1:100:Itrmax1,err_nested_SGD_hist(1:100:Itrmax1),...
%      1:100:Itrmax,err_nested_SGDM_hist(1:100:Itrmax1),1:100:Itrmax,err_static_SGDM_hist(1:100:Itrmax1),...
%      4/3*(1:100:Itrmax2_svrg),err_nested_SVRG_hist(1:100:Itrmax2_svrg),...
%    ritr_Catalyst / Itrmax2 * (1:100:Itrmax2_catalyst), err_nested_Catalyst_hist(1:100:Itrmax2_catalyst),...
%    1:100:Itrmax,err_SPDHG_hist(1:100:Itrmax))
% legend('SASC-SGD','Nested-SGD','Nested-SGDM','Static-SGDM','Nested-SVRG','Nested-Catalyst','SPDHG');
% xlabel('Number of Component Gradient Evaluations');
% ylabel('Relative Error');
% ylim([1e-4 10]);

semilogy(1:100:Itrmax1,err_SASC_hist(1:100:Itrmax1),1:100:Itrmax1,err_nested_SGD_hist(1:100:Itrmax1),...
     4/3*(1:100:Itrmax2_svrg),err_nested_SVRG_hist(1:100:Itrmax2_svrg),...
     4/3*(1:100:Itrmax2_ss),err_nested_SVRG_Screening_hist(1:100:Itrmax2_ss),...
   ritr_Catalyst / Itrmax2 * (1:100:Itrmax2_catalyst), err_nested_Catalyst_hist(1:100:Itrmax2_catalyst),...
   ritr_Catalyst_Screening / Itrmax2 * (1:100:Itrmax2_cs), err_nested_Catalyst_Screening_hist(1:100:Itrmax2_cs),...
   1:100:Itrmax,err_SPDHG_hist(1:100:Itrmax))
legend('SASC-SGD','Nested-SGD','Nested-SVRG','Nested-SVRG-Screening','Nested-Catalyst','Nested-Catalyst-Screening','SPDHG');
xlabel('Number of Component Gradient Evaluations');
ylabel('Relative Error');
ylim([1e-4 10]);